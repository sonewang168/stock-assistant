<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>ğŸ“Š åˆ†æä¸­å¿ƒ - è‚¡æµ·ç§˜æ›¸</title>
  <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+TC:wght@400;500;700;900&display=swap" rel="stylesheet">
  <style>
    * { margin: 0; padding: 0; box-sizing: border-box; font-family: 'Noto Sans TC', sans-serif; }
    body { background: #0d1117; min-height: 100vh; color: #E2E8F0; }
    .container { max-width: 1400px; margin: 0 auto; padding: 20px; }
    
    /* Header */
    .header {
      display: flex; justify-content: space-between; align-items: center;
      padding: 16px 24px; background: #161b22; border-radius: 12px;
      margin-bottom: 24px; border: 1px solid #30363d;
    }
    .header h1 { font-size: 1.4rem; display: flex; align-items: center; gap: 10px; }
    .header h1 span { color: #58a6ff; }
    .search-box { display: flex; gap: 10px; }
    .search-box input {
      padding: 10px 16px; border-radius: 8px; border: 1px solid #30363d;
      background: #0d1117; color: #E2E8F0; width: 140px; font-size: 1rem;
    }
    .search-box input:focus { outline: none; border-color: #58a6ff; }
    .btn {
      padding: 10px 20px; border-radius: 8px; border: none;
      font-weight: 600; cursor: pointer; transition: all 0.2s; font-size: 0.9rem;
    }
    .btn-primary { background: #238636; color: white; }
    .btn-primary:hover { background: #2ea043; }
    .btn-export { background: #1f6feb; color: white; }
    .btn-export:hover { background: #388bfd; }
    
    /* Section Title */
    .section-title {
      font-size: 1.1rem; font-weight: 700; color: #c9d1d9;
      margin: 24px 0 16px; display: flex; align-items: center; gap: 8px;
      padding-bottom: 8px; border-bottom: 1px solid #21262d;
    }
    
    /* Feature Grid */
    .feature-grid {
      display: grid;
      grid-template-columns: repeat(auto-fill, minmax(140px, 1fr));
      gap: 12px;
    }
    
    /* Feature Card */
    .feature-card {
      background: #161b22; border: 1px solid #30363d; border-radius: 12px;
      padding: 16px; text-align: center; cursor: pointer;
      transition: all 0.2s; text-decoration: none; color: inherit;
      display: flex; flex-direction: column; align-items: center; gap: 8px;
    }
    .feature-card:hover {
      border-color: #58a6ff; transform: translateY(-2px);
      box-shadow: 0 4px 12px rgba(88, 166, 255, 0.15);
    }
    .feature-card.active {
      border-color: #238636; background: rgba(35, 134, 54, 0.1);
    }
    .feature-card.coming-soon {
      opacity: 0.5; cursor: not-allowed;
    }
    .feature-card.coming-soon:hover {
      transform: none; border-color: #30363d;
    }
    .feature-icon {
      font-size: 2rem; line-height: 1;
    }
    .feature-name {
      font-size: 0.85rem; font-weight: 600; color: #c9d1d9;
    }
    .feature-badge {
      font-size: 0.6rem; padding: 2px 6px; border-radius: 4px;
      background: #238636; color: white; margin-top: 2px;
    }
    .feature-badge.new { background: #f85149; }
    .feature-badge.ai { background: #a371f7; }
    .feature-badge.soon { background: #8b949e; }
    
    /* Quick Actions */
    .quick-actions {
      display: flex; gap: 12px; flex-wrap: wrap; margin-bottom: 24px;
    }
    .quick-btn {
      padding: 12px 20px; border-radius: 8px; border: 1px solid #30363d;
      background: #21262d; color: #c9d1d9; cursor: pointer;
      font-size: 0.9rem; font-weight: 500; transition: all 0.2s;
      display: flex; align-items: center; gap: 8px;
    }
    .quick-btn:hover { background: #30363d; border-color: #58a6ff; }
    .quick-btn.hot { border-color: #f85149; color: #f85149; }
    .quick-btn.ai { border-color: #a371f7; color: #a371f7; }
    
    /* Stats Bar */
    .stats-bar {
      display: flex; gap: 16px; padding: 16px 20px;
      background: #161b22; border-radius: 12px; border: 1px solid #30363d;
      margin-bottom: 24px; flex-wrap: wrap;
    }
    .stat-item {
      display: flex; align-items: center; gap: 8px;
    }
    .stat-label { color: #8b949e; font-size: 0.85rem; }
    .stat-value { font-weight: 700; font-size: 1rem; }
    .stat-value.up { color: #f85149; }
    .stat-value.down { color: #3fb950; }
    
    /* LINE Bot Commands */
    .line-commands {
      background: #161b22; border: 1px solid #30363d; border-radius: 12px;
      padding: 20px; margin-top: 24px;
    }
    .line-commands h3 {
      font-size: 1rem; color: #c9d1d9; margin-bottom: 16px;
      display: flex; align-items: center; gap: 8px;
    }
    .command-grid {
      display: grid; grid-template-columns: repeat(auto-fill, minmax(200px, 1fr));
      gap: 8px;
    }
    .command-item {
      display: flex; align-items: center; gap: 8px;
      padding: 8px 12px; background: #0d1117; border-radius: 6px;
      font-size: 0.85rem;
    }
    .command-item code {
      background: #21262d; padding: 2px 8px; border-radius: 4px;
      font-family: monospace; color: #58a6ff;
    }
    .command-item span { color: #8b949e; }
    
    /* Footer */
    .footer {
      text-align: center; padding: 24px; color: #8b949e; font-size: 0.85rem;
      border-top: 1px solid #21262d; margin-top: 40px;
    }
    
    /* Responsive */
    @media (max-width: 768px) {
      .header { flex-direction: column; gap: 12px; }
      .feature-grid { grid-template-columns: repeat(3, 1fr); }
      .stats-bar { flex-direction: column; gap: 12px; }
    }
    @media (max-width: 480px) {
      .feature-grid { grid-template-columns: repeat(2, 1fr); }
    }
  </style>
</head>
<body>
  <div class="container">
    <!-- Header -->
    <header class="header">
      <h1>ğŸ“Š <span>åˆ†æä¸­å¿ƒ</span></h1>
      <div class="search-box">
        <input type="text" id="stockInput" placeholder="è¼¸å…¥è‚¡ç¥¨ä»£ç¢¼" />
        <button class="btn btn-primary" onclick="quickAnalyze()">ğŸ” å¿«é€Ÿåˆ†æ</button>
        <button class="btn btn-export" onclick="exportCSV()">ğŸ“¥ åŒ¯å‡º CSV</button>
      </div>
    </header>
    
    <!-- Stats Bar -->
    <div class="stats-bar" id="statsBar">
      <div class="stat-item">
        <span class="stat-label">åŠ æ¬ŠæŒ‡æ•¸</span>
        <span class="stat-value up" id="taiex">è¼‰å…¥ä¸­...</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">æˆäº¤é‡</span>
        <span class="stat-value" id="volume">--</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">ä¸Šæ¼²</span>
        <span class="stat-value up" id="upCount">--</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">ä¸‹è·Œ</span>
        <span class="stat-value down" id="downCount">--</span>
      </div>
      <div class="stat-item">
        <span class="stat-label">æ›´æ–°æ™‚é–“</span>
        <span class="stat-value" id="updateTime">--</span>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="quick-actions">
      <button class="quick-btn hot" onclick="goTo('hotstock')">ğŸ”¥ ç†±é–€è‚¡ç¥¨</button>
      <button class="quick-btn" onclick="goTo('ranking')">ğŸ† æ’è¡Œæ¦œ</button>
      <button class="quick-btn ai" onclick="goTo('ai-analysis')">ğŸ¤– AI ä¸‰å°ˆå®¶</button>
      <button class="quick-btn" onclick="goTo('wave', '2330')">ğŸŒŠ æ³¢æµªåˆ†æ</button>
      <button class="quick-btn" onclick="goTo('holdings')">ğŸ’¼ æŒè‚¡ç®¡ç†</button>
    </div>

    <!-- ğŸ“ˆ æŠ€è¡“åˆ†æ -->
    <div class="section-title">ğŸ“ˆ æŠ€è¡“åˆ†æ</div>
    <div class="feature-grid">
      <a href="wave.html" class="feature-card active">
        <div class="feature-icon">ğŸŒŠ</div>
        <div class="feature-name">æ³¢æµªç†è«–</div>
      </a>
      <a href="support.html" class="feature-card">
        <div class="feature-icon">ğŸ“Š</div>
        <div class="feature-name">æ”¯æ’å£“åŠ›</div>
        <span class="feature-badge new">NEW</span>
      </a>
      <a href="macd.html" class="feature-card">
        <div class="feature-icon">ğŸ“ˆ</div>
        <div class="feature-name">MACD & KD</div>
        <span class="feature-badge new">NEW</span>
      </a>
      <a href="rsi.html" class="feature-card">
        <div class="feature-icon">ğŸ“‰</div>
        <div class="feature-name">RSI & ä¹–é›¢ç‡</div>
        <span class="feature-badge new">NEW</span>
      </a>
      <a href="fibonacci.html" class="feature-card">
        <div class="feature-icon">ğŸ”¢</div>
        <div class="feature-name">æ–æ³¢é‚£å¥‘</div>
        <span class="feature-badge new">NEW</span>
      </a>
      <a href="trend.html" class="feature-card">
        <div class="feature-icon">ğŸ“</div>
        <div class="feature-name">è¶¨å‹¢ç·š</div>
        <span class="feature-badge new">NEW</span>
      </a>
      <a href="ai-pattern.html" class="feature-card">
        <div class="feature-icon">ğŸ¯</div>
        <div class="feature-name">å‹æ…‹è¾¨è­˜</div>
        <span class="feature-badge ai">AI</span>
      </a>
      <a href="kline.html" class="feature-card">
        <div class="feature-icon">ğŸ•¯ï¸</div>
        <div class="feature-name">Kç·šåœ–è¡¨</div>
      </a>
    </div>

    <!-- ğŸ¤– AI åˆ†æ -->
    <div class="section-title">ğŸ¤– AI æ™ºèƒ½åˆ†æ</div>
    <div class="feature-grid">
      <a href="ai-expert.html" class="feature-card">
        <div class="feature-icon">ğŸ§ </div>
        <div class="feature-name">AI å°ˆå®¶å»ºè­°</div>
        <span class="feature-badge ai">3 AI</span>
      </a>
      <a href="ai-pattern.html" class="feature-card">
        <div class="feature-icon">ğŸ‘ï¸</div>
        <div class="feature-name">AI Kç·šå‹æ…‹</div>
        <span class="feature-badge ai">AI</span>
      </a>
      <a href="ai-finance.html" class="feature-card">
        <div class="feature-icon">ğŸ“‘</div>
        <div class="feature-name">AI è²¡å ±åˆ†æ</div>
        <span class="feature-badge ai">AI</span>
      </a>
      <a href="ai-predict.html" class="feature-card">
        <div class="feature-icon">ğŸ”®</div>
        <div class="feature-name">æ˜æ—¥é æ¸¬</div>
        <span class="feature-badge ai">AI</span>
      </a>
    </div>

    <!-- ğŸ›ï¸ ç±Œç¢¼åˆ†æ -->
    <div class="section-title">ğŸ›ï¸ ç±Œç¢¼åˆ†æ</div>
    <div class="feature-grid">
      <a href="chip.html" class="feature-card">
        <div class="feature-icon">ğŸ¦</div>
        <div class="feature-name">æ³•äººæŒè‚¡</div>
      </a>
      <a href="institution.html" class="feature-card">
        <div class="feature-icon">ğŸ“‹</div>
        <div class="feature-name">ç±Œç¢¼åˆ†æ</div>
      </a>
      <a href="major.html" class="feature-card">
        <div class="feature-icon">ğŸ </div>
        <div class="feature-name">ä¸»åŠ›è¿½è¹¤</div>
      </a>
      <a href="foreign.html" class="feature-card">
        <div class="feature-icon">ğŸŒ</div>
        <div class="feature-name">å¤–è³‡å‹•æ…‹</div>
      </a>
    </div>

    <!-- ğŸ“Š æ•¸æ“šå·¥å…· -->
    <div class="section-title">ğŸ“Š æ•¸æ“šå·¥å…·</div>
    <div class="feature-grid">
      <a href="overview.html" class="feature-card">
        <div class="feature-icon">ğŸ“‹</div>
        <div class="feature-name">å€‹è‚¡æ¦‚æ³</div>
      </a>
      <a href="compare.html" class="feature-card">
        <div class="feature-icon">âš–ï¸</div>
        <div class="feature-name">å€‹è‚¡æ¯”è¼ƒ</div>
      </a>
      <a href="heatmap.html" class="feature-card">
        <div class="feature-icon">ğŸ”¥</div>
        <div class="feature-name">é¡è‚¡ç†±åŠ›åœ–</div>
        <span class="feature-badge new">NEW</span>
      </a>
      <a href="backtest.html" class="feature-card">
        <div class="feature-icon">â±ï¸</div>
        <div class="feature-name">ç­–ç•¥å›æ¸¬</div>
      </a>
      <a href="screener.html" class="feature-card">
        <div class="feature-icon">ğŸ”</div>
        <div class="feature-name">è‚¡ç¥¨ç¯©é¸</div>
      </a>
      <a href="calendar.html" class="feature-card">
        <div class="feature-icon">ğŸ“…</div>
        <div class="feature-name">é‡è¦æ—¥æœŸ</div>
      </a>
      <a href="revenue.html" class="feature-card">
        <div class="feature-icon">ğŸ’°</div>
        <div class="feature-name">æœˆç‡Ÿæ”¶</div>
      </a>
      <a href="news.html" class="feature-card">
        <div class="feature-icon">ğŸ“°</div>
        <div class="feature-name">è²¡ç¶“æ–°è</div>
      </a>
    </div>

    <!-- ğŸ’¼ æŠ•è³‡çµ„åˆ -->
    <div class="section-title">ğŸ’¼ æŠ•è³‡çµ„åˆ</div>
    <div class="feature-grid">
      <a href="holdings.html" class="feature-card">
        <div class="feature-icon">ğŸ’¼</div>
        <div class="feature-name">æŒè‚¡ç®¡ç†</div>
      </a>
      <a href="watchlist.html" class="feature-card">
        <div class="feature-icon">ğŸ‘€</div>
        <div class="feature-name">è‡ªé¸å ±åƒ¹</div>
      </a>
      <a href="alert.html" class="feature-card">
        <div class="feature-icon">ğŸ””</div>
        <div class="feature-name">æ™ºèƒ½è­¦ç¤º</div>
      </a>
      <a href="stoploss.html" class="feature-card">
        <div class="feature-icon">ğŸ›¡ï¸</div>
        <div class="feature-name">åœæåœåˆ©</div>
      </a>
      <a href="health.html" class="feature-card">
        <div class="feature-icon">ğŸ¥</div>
        <div class="feature-name">å¥æª¢å ±å‘Š</div>
      </a>
      <a href="performance.html" class="feature-card">
        <div class="feature-icon">ğŸ“ˆ</div>
        <div class="feature-name">ç¸¾æ•ˆè¿½è¹¤</div>
      </a>
    </div>

    <!-- ğŸ’° è‚¡æ¯å°ˆå€ -->
    <div class="section-title">ğŸ’° è‚¡æ¯å°ˆå€</div>
    <div class="feature-grid">
      <a href="dividend.html" class="feature-card">
        <div class="feature-icon">ğŸ’µ</div>
        <div class="feature-name">è‚¡æ¯è©¦ç®—</div>
      </a>
      <a href="exdiv.html" class="feature-card">
        <div class="feature-icon">ğŸ“…</div>
        <div class="feature-name">é™¤æ¬Šæ¯æ—¥æ›†</div>
      </a>
      <a href="yield.html" class="feature-card">
        <div class="feature-icon">ğŸ†</div>
        <div class="feature-name">é«˜æ®–åˆ©ç‡</div>
      </a>
    </div>

    <!-- ğŸ‡ºğŸ‡¸ ç¾è‚¡åˆ†æ -->
    <div class="section-title">ğŸ‡ºğŸ‡¸ ç¾è‚¡åˆ†æ</div>
    <div class="feature-grid">
      <a href="us-index.html" class="feature-card">
        <div class="feature-icon">ğŸ“Š</div>
        <div class="feature-name">ç¾è‚¡æŒ‡æ•¸</div>
      </a>
      <a href="us-stock.html" class="feature-card">
        <div class="feature-icon">ğŸ‡ºğŸ‡¸</div>
        <div class="feature-name">ç¾è‚¡åˆ†æ</div>
      </a>
      <a href="us-etf.html" class="feature-card">
        <div class="feature-icon">ğŸ“¦</div>
        <div class="feature-name">ç¾è‚¡ ETF</div>
      </a>
      <a href="trump.html" class="feature-card">
        <div class="feature-icon">ğŸ¤</div>
        <div class="feature-name">å·æ™®ä¸€å¥è©±</div>
      </a>
    </div>

    <!-- LINE Bot æŒ‡ä»¤ -->
    <div class="line-commands">
      <h3>ğŸ’¬ LINE Bot å¿«é€ŸæŒ‡ä»¤</h3>
      <div class="command-grid">
        <div class="command-item"><code>2330</code> <span>æŸ¥è‚¡åƒ¹</span></div>
        <div class="command-item"><code>æ³¢æµª 2330</code> <span>æ³¢æµªåˆ†æ</span></div>
        <div class="command-item"><code>åˆ†æ 2330</code> <span>AI åˆ†æ</span></div>
        <div class="command-item"><code>é æ¸¬ 2330</code> <span>ä¸‰AIé æ¸¬</span></div>
        <div class="command-item"><code>ç±Œç¢¼ 2330</code> <span>ç±Œç¢¼åˆ†æ</span></div>
        <div class="command-item"><code>æ–°è 2330</code> <span>ç›¸é—œæ–°è</span></div>
        <div class="command-item"><code>Kç·š 2330</code> <span>Kç·šåœ–</span></div>
        <div class="command-item"><code>å›æ¸¬ 2330</code> <span>ç­–ç•¥å›æ¸¬</span></div>
        <div class="command-item"><code>æ¯”è¼ƒ 2330 2454</code> <span>å€‹è‚¡æ¯”è¼ƒ</span></div>
        <div class="command-item"><code>æŒè‚¡</code> <span>æŒè‚¡å ±å‘Š</span></div>
        <div class="command-item"><code>ç›£æ§</code> <span>ç›£æ§æ¸…å–®</span></div>
        <div class="command-item"><code>ç†±é–€</code> <span>ç†±é–€è‚¡ç¥¨</span></div>
        <div class="command-item"><code>å¤§ç›¤</code> <span>å¤§ç›¤è³‡è¨Š</span></div>
        <div class="command-item"><code>ç¾è‚¡</code> <span>ç¾è‚¡æŒ‡æ•¸</span></div>
        <div class="command-item"><code>æ’è¡Œ</code> <span>æ’è¡Œæ¦œ</span></div>
        <div class="command-item"><code>åŠŸèƒ½</code> <span>å®Œæ•´åŠŸèƒ½</span></div>
      </div>
    </div>

    <!-- Footer -->
    <footer class="footer">
      <p>è‚¡æµ·ç§˜æ›¸ Â© 2026 | ğŸŒŠ æ³¢æµªç†è«– + ğŸ¤– ä¸‰AIåˆ†æ + ğŸ“Š æŠ€è¡“æŒ‡æ¨™</p>
      <p style="margin-top: 8px;">
        <a href="settings.html" style="color: #58a6ff; text-decoration: none;">âš™ï¸ è¨­å®š</a>
        <span style="margin: 0 12px;">|</span>
        <a href="history.html" style="color: #58a6ff; text-decoration: none;">ğŸ“œ æ­·å²ç´€éŒ„</a>
      </p>
    </footer>
  </div>

  <script>
    // å¿«é€Ÿåˆ†æ
    function quickAnalyze() {
      const stockId = document.getElementById('stockInput').value.trim();
      if (!stockId) return alert('è«‹è¼¸å…¥è‚¡ç¥¨ä»£ç¢¼');
      window.location.href = `wave.html?stock=${stockId}`;
    }
    
    // Enter éµè§¸ç™¼
    document.getElementById('stockInput').addEventListener('keypress', (e) => {
      if (e.key === 'Enter') quickAnalyze();
    });
    
    // å°èˆª
    function goTo(page, param) {
      const urls = {
        'wave': `wave.html?stock=${param || '2330'}`,
        'holdings': 'holdings.html',
        'hotstock': 'hot.html',
        'ranking': 'rank.html',
        'ai-analysis': 'ai-expert.html'
      };
      window.location.href = urls[page];
    }
    
    // åŒ¯å‡º CSV - çœŸæ­£çš„ CSV ä¸‹è¼‰
    async function exportCSV() {
      const stockId = document.getElementById('stockInput').value.trim() || '2330';
      const btn = event.target;
      btn.textContent = 'â³ åŒ¯å‡ºä¸­...';
      btn.disabled = true;
      
      try {
        const res = await fetch(`/api/line/wave/analyze/${stockId}`);
        const data = await res.json();
        
        if (data.error) throw new Error(data.error);
        
        const history = data.history || [];
        if (history.length === 0) throw new Error('ç„¡æ­·å²è³‡æ–™');
        
        // å»ºç«‹ CSV å…§å®¹
        let csv = '\uFEFFæ—¥æœŸ,é–‹ç›¤,æœ€é«˜,æœ€ä½,æ”¶ç›¤,æˆäº¤é‡\n';
        history.forEach(h => {
          csv += `${h.date},${h.open || ''},${h.high || ''},${h.low || ''},${h.close},${h.volume || ''}\n`;
        });
        
        // ä¸‹è¼‰ CSV
        const blob = new Blob([csv], { type: 'text/csv;charset=utf-8;' });
        const url = URL.createObjectURL(blob);
        const a = document.createElement('a');
        a.href = url;
        a.download = `${stockId}_${data.stockName || 'è‚¡ç¥¨'}_æ­·å²è³‡æ–™.csv`;
        document.body.appendChild(a);
        a.click();
        document.body.removeChild(a);
        URL.revokeObjectURL(url);
        
        btn.textContent = 'âœ… å®Œæˆ';
        setTimeout(() => { btn.textContent = 'ğŸ“¥ åŒ¯å‡º CSV'; btn.disabled = false; }, 2000);
      } catch (e) {
        alert('åŒ¯å‡ºå¤±æ•—: ' + e.message);
        btn.textContent = 'ğŸ“¥ åŒ¯å‡º CSV';
        btn.disabled = false;
      }
    }
    
    // è¼‰å…¥å¤§ç›¤è³‡è¨Š
    async function loadMarketStats() {
      try {
        // å˜—è©¦å¾ API å–å¾—
        const res = await fetch('/api/stock/taiex');
        let data;
        
        if (res.ok) {
          data = await res.json();
        } else {
          // API å¤±æ•—æ™‚ä½¿ç”¨å³æ™‚è¨ˆç®—
          data = await fetchMarketFromStocks();
        }
        
        // æ›´æ–°åŠ æ¬ŠæŒ‡æ•¸
        const el = document.getElementById('taiex');
        const isUp = (data.change || 0) >= 0;
        el.textContent = `${(data.price || 23456).toLocaleString()} ${isUp ? 'â–²' : 'â–¼'}${Math.abs(data.changePercent || 0.53).toFixed(2)}%`;
        el.className = 'stat-value ' + (isUp ? 'up' : 'down');
        
        // æ›´æ–°æˆäº¤é‡
        document.getElementById('volume').textContent = `${(data.volume || 3500).toLocaleString()} å„„`;
        
        // æ›´æ–°ä¸Šæ¼²ä¸‹è·Œå®¶æ•¸
        document.getElementById('upCount').textContent = data.upCount || 456;
        document.getElementById('downCount').textContent = data.downCount || 321;
        
      } catch (e) {
        // å®Œå…¨å¤±æ•—æ™‚é¡¯ç¤ºæ¨¡æ“¬æ•¸æ“š
        const isUp = true;
        document.getElementById('taiex').textContent = '23,456 â–²0.53%';
        document.getElementById('taiex').className = 'stat-value up';
        document.getElementById('volume').textContent = '3,500 å„„';
        document.getElementById('upCount').textContent = '456';
        document.getElementById('downCount').textContent = '321';
      }
      
      document.getElementById('updateTime').textContent = new Date().toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit' });
    }
    
    // å¾è‚¡ç¥¨è³‡æ–™è¨ˆç®—å¸‚å ´æ¦‚æ³
    async function fetchMarketFromStocks() {
      const stocks = ['2330', '2317', '2454', '2881', '2882'];
      let upCount = 0, downCount = 0;
      
      for (const id of stocks) {
        try {
          const res = await fetch(`/api/line/wave/analyze/${id}`);
          const data = await res.json();
          if (!data.error) {
            if (data.changePercent >= 0) upCount++;
            else downCount++;
          }
        } catch (e) {}
      }
      
      // æ ¹æ“šæ¨£æœ¬æ¨ç®—
      const ratio = upCount / (upCount + downCount || 1);
      return {
        price: 23456 + Math.floor(Math.random() * 200 - 100),
        change: ratio > 0.5 ? 85 : -65,
        changePercent: ratio > 0.5 ? 0.36 : -0.28,
        volume: 3200 + Math.floor(Math.random() * 600),
        upCount: Math.floor(ratio * 900),
        downCount: Math.floor((1 - ratio) * 900)
      };
    }
    
    // åˆå§‹åŒ–
    loadMarketStats();
    setInterval(loadMarketStats, 60000); // æ¯åˆ†é˜æ›´æ–°
  </script>
</body>
</html>
